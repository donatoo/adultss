<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Dynamic Iframe Loader</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f8f8f8;
      padding: 20px;
      text-align: center;
    }

    iframe {
      width: 100%;
      height: 80vh;
      border: none;
      display: none;
    }

    /* Loading animation */
    .loader {
      margin: 40px auto;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: #3498db;
      animation: pulse 1s infinite ease-in-out;
    }

    @keyframes pulse {
      0% { transform: scale(0.8); opacity: 0.6; }
      50% { transform: scale(1); opacity: 1; }
      100% { transform: scale(0.8); opacity: 0.6; }
    }

    /* Adblock message */
    #adblock-warning {
      display: none;
      padding: 20px;
      border-radius: 10px;
      background: #ff4444;
      color: white;
      font-size: 20px;
      font-weight: bold;
    }
  </style>
</head>
<body>

<h2 id="status">Loading content…</h2>

<div id="loader" class="loader"></div>

<div id="adblock-warning">
  ⚠️ AdBlock detected!<br>
  Please disable your AdBlocker and refresh the page.
</div>

<iframe id="viewer"></iframe>

<script>
// -----------------
// Accurate AdBlock Detector
// -----------------
function detectAdBlock() {
  return new Promise(resolve => {
    let bait = document.createElement("div");
    bait.className = "adsbox ad-banner ad-banner-top ad-container";
    bait.style.position = "absolute";
    bait.style.left = "-9999px";
    document.body.appendChild(bait);

    setTimeout(() => {
      const blocked = (
        bait.offsetHeight === 0 ||
        bait.offsetParent === null ||
        window.getComputedStyle(bait).display === "none"
      );

      bait.remove();
      resolve(blocked);
    }, 300);
  });
}

// -----------------
// Start detection
// -----------------
detectAdBlock().then(isBlocked => {

  if (isBlocked) {
    document.getElementById("loader").style.display = "none";
    document.getElementById("status").innerText = "AdBlock Detected!";
    document.getElementById("adblock-warning").style.display = "block";
    return; // STOP EVERYTHING
  }

  // If OK → continue loading url
  startLoadingProcess();
});


// -----------------
// Main loader function
// -----------------
function startLoadingProcess() {
  const params = new URLSearchParams(window.location.search);
  const id = params.get("id");

  if (!id) {
    document.getElementById("status").innerText = "Error: No ID provided in URL.";
    return;
  }

  loadURLFromText(id);
}


// -----------------
// Load URL from TXT
// -----------------
function loadURLFromText(id) {
  fetch("links.txt")
    .then(response => response.text())
    .then(text => {
      const lines = text.split("\n");
      let foundURL = null;

      for (let line of lines) {
        line = line.trim();
        if (line.startsWith(id + "=")) {
          foundURL = line.split("=")[1].trim();
          break;
        }
      }

      if (!foundURL) {
        document.getElementById("status").innerText = "No URL found for ID: " + id;
        document.getElementById("loader").style.display = "none";
        return;
      }

      const iframe = document.getElementById("viewer");

      iframe.onload = () => {
        document.getElementById("loader").style.display = "none";
        iframe.style.display = "block";
        document.getElementById("status").innerText = "Loaded:";
      };

      iframe.src = foundURL;
    })
    .catch(err => {
      document.getElementById("status").innerText = "Error: " + err;
      document.getElementById("loader").style.display = "none";
    });
}
</script>

</body>
</html>
